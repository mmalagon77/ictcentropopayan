<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trivia: El Tren de la Vida</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Iconos -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@300;400;600&family=Nunito:wght@400;700&display=swap');

        body {
            font-family: 'Nunito', sans-serif;
            background-color: #f0f9ff;
            background-image: radial-gradient(#e0f2fe 1px, transparent 1px);
            background-size: 20px 20px;
        }

        h1, h2, h3 {
            font-family: 'Fredoka', sans-serif;
        }

        .train-card {
            background: white;
            border-radius: 1.5rem;
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border-bottom: 6px solid #e2e8f0;
        }

        .option-btn {
            transition: all 0.2s;
            border-bottom: 4px solid #b4c6fc;
        }
        
        .option-btn:active {
            transform: translateY(2px);
            border-bottom: 0px solid transparent;
        }

        .option-btn:hover {
            background-color: #eff6ff;
        }

        /* Animación de entrada */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .correct-anim {
            background-color: #86efac !important; /* Green */
            border-color: #22c55e !important;
            color: #064e3b;
        }

        .wrong-anim {
            background-color: #fda4af !important; /* Red */
            border-color: #ef4444 !important;
            color: #7f1d1d;
        }

        /* Decoración de vías de tren */
        .track-decoration {
            height: 20px;
            background: repeating-linear-gradient(
                90deg,
                #78350f,
                #78350f 10px,
                transparent 10px,
                transparent 20px
            );
            opacity: 0.3;
            margin-top: 5px;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <!-- CONTENEDOR PRINCIPAL -->
    <main class="w-full max-w-2xl">
        
        <!-- PANTALLA DE INICIO -->
        <div id="start-screen" class="train-card p-8 text-center fade-in">
            <div class="mb-6 flex justify-center">
                <div class="bg-blue-100 p-4 rounded-full">
                    <i data-lucide="train-front" class="w-16 h-16 text-blue-600"></i>
                </div>
            </div>
            <h1 class="text-4xl font-bold text-slate-800 mb-2">El Orden Correcto</h1>
            <p class="text-slate-500 mb-8 text-lg">Trivia sobre el Plan Pastoral y el Tren de la Vida</p>
            
            <div class="space-y-4 max-w-sm mx-auto">
                <div class="text-left">
                    <label class="block text-sm font-bold text-slate-700 mb-1">Tu Nombre</label>
                    <input type="text" id="username" placeholder="Escribe tu nombre aquí..." class="w-full p-4 rounded-xl border-2 border-slate-200 focus:border-blue-500 focus:outline-none text-lg transition-colors">
                </div>
                <button onclick="startGame()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-4 rounded-xl shadow-lg transform transition hover:-translate-y-1 text-xl">
                    ¡Subir al Tren!
                </button>
            </div>
        </div>

        <!-- PANTALLA DE JUEGO -->
        <div id="game-screen" class="hidden">
            <!-- Barra de Progreso -->
            <div class="mb-6 flex items-center justify-between bg-white p-3 rounded-xl shadow-sm border border-slate-100">
                <div class="flex items-center gap-2">
                    <span class="bg-blue-100 text-blue-700 px-3 py-1 rounded-lg font-bold text-sm">Pregunta <span id="current-q-num">1</span>/10</span>
                </div>
                <div class="flex items-center gap-2">
                    <span class="text-slate-500 text-sm">Puntos:</span>
                    <span id="score-display" class="font-bold text-blue-600 text-xl">0</span>
                </div>
            </div>

            <!-- Tarjeta de Pregunta -->
            <div class="train-card p-6 md:p-8 relative overflow-hidden">
                <!-- Decoración -->
                <div class="absolute top-0 left-0 w-full h-2 bg-blue-500"></div>
                
                <div id="question-container" class="fade-in">
                    <h2 id="question-text" class="text-2xl font-bold text-slate-800 mb-6 leading-tight">
                        ¿Pregunta?
                    </h2>

                    <!-- Botón de Ayuda -->
                    <div class="mb-6">
                        <button onclick="toggleHint()" class="text-sm flex items-center gap-2 text-amber-600 hover:text-amber-700 font-semibold bg-amber-50 px-3 py-2 rounded-lg transition-colors">
                            <i data-lucide="lightbulb" class="w-4 h-4"></i>
                            <span id="hint-label">Ver Pista</span>
                        </button>
                        <div id="hint-text" class="hidden mt-2 p-3 bg-amber-50 text-amber-800 text-sm rounded-lg border border-amber-200 italic">
                            Aquí aparecerá la pista...
                        </div>
                    </div>

                    <!-- Opciones -->
                    <div id="options-container" class="grid gap-3">
                        <!-- Se llenan con JS -->
                    </div>
                </div>
            </div>
            
            <div class="track-decoration rounded-full mt-4"></div>
        </div>

        <!-- PANTALLA DE RESULTADOS -->
        <div id="result-screen" class="hidden train-card p-8 text-center fade-in">
            <div class="mb-6 flex justify-center">
                <div id="result-icon-container" class="p-4 rounded-full">
                    <!-- Icono dinámico -->
                </div>
            </div>
            
            <h2 class="text-3xl font-bold text-slate-800 mb-2">Resumen del Viaje</h2>
            <p id="result-greeting" class="text-xl text-slate-600 mb-6">Hola, Nombre</p>
            
            <div class="bg-slate-50 rounded-xl p-6 mb-8 border border-slate-200">
                <div class="text-sm text-slate-500 uppercase tracking-wide font-bold mb-1">Calificación Final</div>
                <div id="final-score" class="text-5xl font-bold text-blue-600 mb-2">0/10</div>
                <div id="final-message" class="text-lg font-medium">Mensaje</div>
            </div>

            <button onclick="location.reload()" class="w-full bg-slate-800 hover:bg-slate-900 text-white font-bold py-4 rounded-xl shadow-lg transform transition hover:-translate-y-1 text-lg flex items-center justify-center gap-2">
                <i data-lucide="rotate-ccw" class="w-5 h-5"></i> Intentar de nuevo
            </button>
        </div>

    </main>

    <!-- MODAL DE FEEDBACK (Respuesta Correcta/Incorrecta) -->
    <div id="feedback-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm hidden flex items-center justify-center z-50 p-4">
        <div class="bg-white rounded-2xl p-6 max-w-md w-full shadow-2xl transform scale-100 transition-transform">
            <div class="text-center mb-4">
                <div id="modal-icon" class="mx-auto w-16 h-16 rounded-full flex items-center justify-center mb-3">
                    <!-- Icono -->
                </div>
                <h3 id="modal-title" class="text-2xl font-bold mb-1">¡Correcto!</h3>
                <p id="modal-message" class="text-slate-600">Explicación breve.</p>
            </div>
            
            <div id="correct-answer-box" class="hidden bg-red-50 p-3 rounded-lg border border-red-100 mb-4 text-left">
                <span class="text-xs font-bold text-red-500 uppercase">La respuesta correcta era:</span>
                <p id="correct-answer-text" class="text-slate-800 font-medium mt-1">Texto respuesta</p>
            </div>

            <button onclick="nextQuestion()" class="w-full bg-blue-600 text-white font-bold py-3 rounded-xl hover:bg-blue-700 transition">
                Continuar
            </button>
        </div>
    </div>

    <script>
        // --- BANCO DE PREGUNTAS (20 Total) ---
        const allQuestions = [
            {
                q: "¿Qué representa el tren en la analogía presentada?",
                options: ["Nuestra Vida", "La Iglesia", "El Trabajo", "Un Viaje de vacaciones"],
                correct: 0,
                hint: "Es algo que nos pertenece y debemos aprender a manejar correctamente."
            },
            {
                q: "¿Quién debe ir en el PRIMER vagón del tren?",
                options: ["Los Sentimientos", "La Fe", "Dios y su Palabra", "La Familia"],
                correct: 2,
                hint: "Es el conductor, quien conoce todo el camino y el destino."
            },
            {
                q: "¿Qué representa el SEGUNDO vagón (el combustible)?",
                options: ["Las Emociones", "La Fe", "El Dinero", "La Voluntad"],
                correct: 1,
                hint: "Necesita ser alimentada constantemente para que el tren se mueva."
            },
            {
                q: "¿Qué representa el TERCER vagón (los pasajeros)?",
                options: ["La Fe", "Los Pensamientos", "Los Sentimientos", "Los Amigos"],
                correct: 2,
                hint: "Se suben en una estación y se bajan en otra, no son permanentes."
            },
            {
                q: "¿Por qué los sentimientos NO deben conducir el tren?",
                options: ["Porque son pasajeros y cambiantes", "Porque son malos", "Porque no tienen licencia", "Porque pesan mucho"],
                correct: 0,
                hint: "Si basamos la vida en ellos, sería una montaña rusa inestable."
            },
            {
                q: "¿Qué sucede si no alimentamos el combustible (La Fe)?",
                options: ["El tren va más rápido", "El tren se apaga o detiene", "El tren explota", "Nada, sigue igual"],
                correct: 1,
                hint: "El carbón necesita fuego para funcionar y dar energía."
            },
            {
                q: "Según Juan 10:25-27, ¿Qué hacen las ovejas de Jesús?",
                options: ["Comen pasto", "Oyen su voz y le siguen", "Se pierden siempre", "Duermen mucho"],
                correct: 1,
                hint: "Hay tres acciones clave: Oír, Creer y..."
            },
            {
                q: "¿Cuál es el orden CORRECTO de los vagones?",
                options: ["Fe -> Sentimientos -> Dios", "Sentimientos -> Fe -> Dios", "Dios -> Fe -> Sentimientos", "Dios -> Sentimientos -> Fe"],
                correct: 2,
                hint: "Primero el conductor, luego el combustible, al final los pasajeros."
            },
            {
                q: "¿Qué característica tiene el Conductor (Dios)?",
                options: ["Solo ve el presente", "Tiene vista completa del camino", "A veces se pierde", "No sabe manejar"],
                correct: 1,
                hint: "Conoce por dónde ha pasado el tren y para dónde va."
            },
            {
                q: "Las tres acciones del proceso (Trencito) son:",
                options: ["Oír, Creer, Seguir", "Ver, Sentir, Llorar", "Correr, Saltar, Reír", "Leer, Escribir, Hablar"],
                correct: 0,
                hint: "Relacionado con la cita bíblica de las ovejas."
            },
            {
                q: "¿Qué pasa si las emociones toman el control de nuestra vida?",
                options: ["Somos más felices", "Tomamos decisiones a la ligera y nos arrepentimos", "Llegamos más rápido", "Dios se alegra"],
                correct: 1,
                hint: "Las emociones a veces nos juegan malas pasadas como el miedo o la ira."
            },
            {
                q: "¿A qué elemento físico se compara la Fe en el ejemplo?",
                options: ["Al Carbón (Combustible)", "A las Ruedas", "A la Ventana", "Al Humo"],
                correct: 0,
                hint: "Tiene la capacidad de dar energía para que se mueva todo."
            },
            {
                q: "¿Qué debemos hacer con 'Oír'?",
                options: ["Oír música relajante", "Oír la palabra de Dios en la Biblia", "Oír los chismes", "Oír a nuestros sentimientos"],
                correct: 1,
                hint: "Es el primer paso para conectar con el Conductor."
            },
            {
                q: "¿Son malos los sentimientos?",
                options: ["Sí, siempre", "No, pero no deben dirigir la vida", "Solo los tristes", "No existen"],
                correct: 1,
                hint: "Van en el último vagón, no se eliminan, se ordenan."
            },
            {
                q: "¿Cómo se llama la parte mecánica que permite avanzar al tren?",
                options: ["El vagón de pasajeros", "El vagón del conductor (Máquina)", "El techo", "Las vías"],
                correct: 1,
                hint: "Es donde va Dios, Él tiene el poder."
            },
            {
                q: "Completar la frase: 'Le creo más a ___ que a cualquier otra cosa'.",
                options: ["Mis amigos", "Mis miedos", "Dios", "Las noticias"],
                correct: 2,
                hint: "Esto ayuda a tener la fe firme."
            },
            {
                q: "¿Qué debemos hacer a veces con nuestras emociones para seguir a Dios?",
                options: ["Negarnos a ellas si nos controlan mal", "Obedecerlas siempre", "Nunca sentirlas", "Gritar fuerte"],
                correct: 0,
                hint: "No caminamos por lo que sentimos, sino por lo que Dios dice."
            },
            {
                q: "¿Qué ejemplos de emociones negativas menciona el texto?",
                options: ["Alegría y Paz", "Miedo, ira, rencor", "Hambre y Sueño", "Sorpresa y Risa"],
                correct: 1,
                hint: "Son fortalezas que a veces toman el control inadecuadamente."
            },
            {
                q: "¿Quién conoce el origen de las cosas que andan mal en nosotros?",
                options: ["Nosotros mismos", "El Conductor (Dios)", "Nuestros padres", "Nadie"],
                correct: 1,
                hint: "Él nota cuando hay algo fuera de lo normal en el tren."
            },
            {
                q: "La tarea final del documento propone escribir 5...",
                options: ["Canciones favoritas", "Deseos futuros", "Sentimientos negativos que nos controlan", "Nombres de amigos"],
                correct: 2,
                hint: "Para identificarlos y que no tomen el control."
            }
        ];

        // --- ESTADO DEL JUEGO ---
        let gameQuestions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let userName = "";

        // --- FUNCIONES ---

        // Inicializar iconos
        lucide.createIcons();

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function startGame() {
            const nameInput = document.getElementById('username');
            if (!nameInput.value.trim()) {
                alert("¡Por favor escribe tu nombre para comenzar!");
                return;
            }
            userName = nameInput.value;
            
            // Seleccionar 10 preguntas aleatorias
            const shuffled = shuffleArray([...allQuestions]);
            gameQuestions = shuffled.slice(0, 10);
            
            currentQuestionIndex = 0;
            score = 0;
            
            // Actualizar UI
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');
            document.getElementById('result-screen').classList.add('hidden');
            updateScore();
            
            loadQuestion();
        }

        function loadQuestion() {
            const qData = gameQuestions[currentQuestionIndex];
            
            // Actualizar textos
            document.getElementById('current-q-num').textContent = currentQuestionIndex + 1;
            document.getElementById('question-text').textContent = qData.q;
            
            // Resetear Pista
            document.getElementById('hint-text').classList.add('hidden');
            document.getElementById('hint-text').textContent = qData.hint;
            document.getElementById('hint-label').textContent = "Ver Pista";
            
            // Generar Opciones
            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';
            
            qData.options.forEach((opt, index) => {
                const btn = document.createElement('button');
                btn.className = "option-btn w-full text-left bg-white border-2 border-slate-200 text-slate-700 font-semibold p-4 rounded-xl hover:border-blue-300";
                btn.innerHTML = `<span class="inline-block w-6 h-6 rounded-full bg-slate-100 text-slate-500 text-center text-sm leading-6 mr-3">${String.fromCharCode(65 + index)}</span> ${opt}`;
                btn.onclick = () => checkAnswer(index, qData.correct, qData.options[qData.correct]);
                optionsContainer.appendChild(btn);
            });

            // Animación suave de entrada
            const container = document.getElementById('question-container');
            container.classList.remove('fade-in');
            void container.offsetWidth; // Trigger reflow
            container.classList.add('fade-in');
        }

        function toggleHint() {
            const hintBox = document.getElementById('hint-text');
            const hintLabel = document.getElementById('hint-label');
            if (hintBox.classList.contains('hidden')) {
                hintBox.classList.remove('hidden');
                hintLabel.textContent = "Ocultar Pista";
            } else {
                hintBox.classList.add('hidden');
                hintLabel.textContent = "Ver Pista";
            }
        }

        function checkAnswer(selectedIndex, correctIndex, correctText) {
            const isCorrect = selectedIndex === correctIndex;
            
            if (isCorrect) {
                score++;
                updateScore();
                showModal(true, null);
            } else {
                showModal(false, correctText);
            }
        }

        function showModal(isCorrect, correctText) {
            const modal = document.getElementById('feedback-modal');
            const iconContainer = document.getElementById('modal-icon');
            const title = document.getElementById('modal-title');
            const message = document.getElementById('modal-message');
            const correctBox = document.getElementById('correct-answer-box');
            const correctTextElem = document.getElementById('correct-answer-text');

            modal.classList.remove('hidden');

            if (isCorrect) {
                iconContainer.className = "mx-auto w-16 h-16 rounded-full flex items-center justify-center mb-3 bg-green-100 text-green-600";
                iconContainer.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"></polyline></svg>';
                title.textContent = "¡Excelente!";
                title.className = "text-2xl font-bold mb-1 text-green-700";
                message.textContent = "Has sumado 1 punto a tu viaje.";
                correctBox.classList.add('hidden');
            } else {
                iconContainer.className = "mx-auto w-16 h-16 rounded-full flex items-center justify-center mb-3 bg-red-100 text-red-600";
                iconContainer.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>';
                title.textContent = "¡Vaya, casi!";
                title.className = "text-2xl font-bold mb-1 text-red-700";
                message.textContent = "Esa no es la respuesta correcta.";
                
                correctTextElem.textContent = correctText;
                correctBox.classList.remove('hidden');
            }
        }

        function nextQuestion() {
            document.getElementById('feedback-modal').classList.add('hidden');
            
            currentQuestionIndex++;
            
            if (currentQuestionIndex < 10) {
                loadQuestion();
            } else {
                finishGame();
            }
        }

        function updateScore() {
            document.getElementById('score-display').textContent = score;
        }

        function finishGame() {
            document.getElementById('game-screen').classList.add('hidden');
            const resultScreen = document.getElementById('result-screen');
            resultScreen.classList.remove('hidden');
            
            document.getElementById('result-greeting').textContent = `¡Bien hecho, ${userName}!`;
            document.getElementById('final-score').textContent = `${score}/10`;
            
            const messageEl = document.getElementById('final-message');
            const iconContainer = document.getElementById('result-icon-container');

            if (score >= 7) {
                messageEl.textContent = "¡Felicidades! Has superado el ejercicio. Tu tren marcha en orden divino.";
                messageEl.className = "text-lg font-bold text-green-600";
                iconContainer.className = "p-4 rounded-full bg-green-100";
                iconContainer.innerHTML = '<i data-lucide="trophy" class="w-16 h-16 text-green-600"></i>';
            } else {
                messageEl.textContent = "Aún te falta un poco. Repasa el Plan Pastoral e intenta de nuevo para ordenar los vagones.";
                messageEl.className = "text-lg font-bold text-amber-600";
                iconContainer.className = "p-4 rounded-full bg-amber-100";
                iconContainer.innerHTML = '<i data-lucide="book-open" class="w-16 h-16 text-amber-600"></i>';
            }
            lucide.createIcons();
        }

    </script>
</body>
</html>